<!DOCTYPE html>
<html>
<body>

<h2>Upload File</h2>

<input type="file" id="file">
<button onclick="upload()">Submit</button>

<p id="status"></p>

<script>
function upload() {
  const file = document.getElementById("file").files[0];
  if (!file) {
    alert("File select kar");
    return;
  }

  const reader = new FileReader();
  reader.onload = function () {

    const base64 = reader.result.split(",")[1];

    fetch("https://script.google.com/macros/s/AKfycbzSuXaRlI1ZZB8x228Aa8ebX_bmO3df7iTropOXTzcq-RGANIisiXZXQap-LYhDD30s/exec", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        filename: file.name,
        mimeType: file.type,
        data: base64
      })
    })
    .then(res => res.text())
    .then(txt => document.getElementById("status").innerText = txt)
    .catch(() => alert("Upload failed"));
  };

  reader.readAsDataURL(file);
}
</script>

</body>
</html>
