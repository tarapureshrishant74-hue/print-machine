<script>
function upload() {
  var file = document.getElementById("file").files[0];
  if (!file) {
    alert("File select karo");
    return;
  }

  var reader = new FileReader();
  reader.onload = function() {

    var base64Data = reader.result.split(",")[1]; // IMPORTANT

    fetch("https://script.google.com/macros/s/AKfycbwtAZ0NlgpyJf5343Md30GQi_r34IWqZTfa3GTGl7yPI8rLR_jm8BJOIj107Vcc8-E2sQ/exec", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        filename: file.name,
        mimeType: file.type,
        data: base64Data
      })
    })
    .then(res => res.text())
    .then(txt => document.getElementById("status").innerText = txt)
    .catch(err => alert("Upload failed"));
  };

  reader.readAsDataURL(file);
}
</script>
